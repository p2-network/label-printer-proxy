import handlebars from "handlebars";
import { readFile } from "node:fs/promises";
import { resolve } from "node:path";

// grumble grumble node / dymo
process.env.NODE_TLS_REJECT_UNAUTHORIZED = "0";

const host = process.env.DYMO_HOST ?? "localhost";

const printerName = "Dymo Label Writer 550 Turbo on DYMOLW550T223ff1E";
// const printerName = "DYMO Label Writer 5XL on DYMOLW5XL30c12dE";

// const printersRequest = await fetch('https://' + host + ':41951/DYMO/DLS/Printing/GetPrinters');
// const printersText = await printersRequest.text();

// console.log('said', printersText);

// const labelName = resolve("./asset-large.dymo.hbs");
const labelName = resolve("./small.dymo.hbs");

const templateData = await readFile(labelName);

// console.log("templateData", templateData.toString());

const template = handlebars.default.compile(templateData.toString());

if (process.argv.length < 3) {
  throw new Error("Usage: node test.mjs ASSET_ID");
}

const tag = process.argv[2];

const labelXml = template({
  qrDataString: `URL:https://a.twopats.live/${tag}`,
  qrDataURL: `https://a.twopats.live/${tag}`,
  labelText: tag
});

// console.log("labelXml", labelXml);

const body = new URLSearchParams({
  printerName,
  printParamsXml: "",
  labelXml,
  labelSetXml: ""
});

// const body =
//   "printerName=" +
//   encodeURIComponent(printerName) +
//   "&printParamsXml=" +
//   "&labelXml=" +
//   encodeURIComponent(labelXml) +
//   // %3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22utf-8%22%3F%3E%3CDesktopLabel%20Version%3D%221%22%3E%0A%20%20%3CDYMOLabel%20Version%3D%223%22%3E%0A%20%20%20%20%3CDescription%3EDYMO%20Label%3C%2FDescription%3E%0A%20%20%20%20%3COrientation%3EPortrait%3C%2FOrientation%3E%0A%20%20%20%20%3CLabelName%3E1933083%20Drbl%201%20x%201%20in%3C%2FLabelName%3E%0A%20%20%20%20%3CInitialLength%3E0%3C%2FInitialLength%3E%0A%20%20%20%20%3CBorderStyle%3ESolidLine%3C%2FBorderStyle%3E%0A%20%20%20%20%3CDYMORect%3E%0A%20%20%20%20%20%20%3CDYMOPoint%3E%0A%20%20%20%20%20%20%20%20%3CX%3E0.03999997%3C%2FX%3E%0A%20%20%20%20%20%20%20%20%3CY%3E0.1%3C%2FY%3E%0A%20%20%20%20%20%20%3C%2FDYMOPoint%3E%0A%20%20%20%20%20%20%3CSize%3E%0A%20%20%20%20%20%20%20%20%3CWidth%3E0.9033334%3C%2FWidth%3E%0A%20%20%20%20%20%20%20%20%3CHeight%3E0.84%3C%2FHeight%3E%0A%20%20%20%20%20%20%3C%2FSize%3E%0A%20%20%20%20%3C%2FDYMORect%3E%0A%20%20%20%20%3CBorderColor%3E%0A%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%3C%2FBorderColor%3E%0A%20%20%20%20%3CBorderThickness%3E1%3C%2FBorderThickness%3E%0A%20%20%20%20%3CShow_Border%3EFalse%3C%2FShow_Border%3E%0A%20%20%20%20%3CDynamicLayoutManager%3E%0A%20%20%20%20%20%20%3CRotationBehavior%3EClearObjects%3C%2FRotationBehavior%3E%0A%20%20%20%20%20%20%3CLabelObjects%3E%0A%20%20%20%20%20%20%20%20%3CQRCodeObject%3E%0A%20%20%20%20%20%20%20%20%20%20%3CName%3EIQRCodeObject0%3C%2FName%3E%0A%20%20%20%20%20%20%20%20%20%20%3CBrushes%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CBackgroundBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%221%22%20G%3D%221%22%20B%3D%221%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FBackgroundBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CBorderBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FBorderBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CStrokeBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FStrokeBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CFillBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FFillBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FBrushes%3E%0A%20%20%20%20%20%20%20%20%20%20%3CRotation%3ERotation0%3C%2FRotation%3E%0A%20%20%20%20%20%20%20%20%20%20%3COutlineThickness%3E1%3C%2FOutlineThickness%3E%0A%20%20%20%20%20%20%20%20%20%20%3CIsOutlined%3EFalse%3C%2FIsOutlined%3E%0A%20%20%20%20%20%20%20%20%20%20%3CBorderStyle%3ESolidLine%3C%2FBorderStyle%3E%0A%20%20%20%20%20%20%20%20%20%20%3CMargin%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDYMOThickness%20Left%3D%220%22%20Top%3D%220%22%20Right%3D%220%22%20Bottom%3D%220%22%2F%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FMargin%3E%0A%20%20%20%20%20%20%20%20%20%20%3CBarcodeFormat%3EQRCode%3C%2FBarcodeFormat%3E%0A%20%20%20%20%20%20%20%20%20%20%3CData%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDataString%3EURL%3Ahttps%3A%2F%2Fa.twopats.live%2FTEST%3C%2FDataString%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FData%3E%0A%20%20%20%20%20%20%20%20%20%20%3CHorizontalAlignment%3ECenter%3C%2FHorizontalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%3CVerticalAlignment%3EMiddle%3C%2FVerticalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%3CSize%3EAutoFit%3C%2FSize%3E%0A%20%20%20%20%20%20%20%20%20%20%3CEQRCodeType%3EQRCodeWebPage%3C%2FEQRCodeType%3E%0A%20%20%20%20%20%20%20%20%20%20%3CWebAddressDataHolder%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDataString%3Ehttps%3A%2F%2Fa.twopats.live%2FTP00085%3C%2FDataString%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FWebAddressDataHolder%3E%0A%20%20%20%20%20%20%20%20%20%20%3CObjectLayout%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDYMOPoint%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CX%3E0.2198809%3C%2FX%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CY%3E0.2518374%3C%2FY%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FDYMOPoint%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CSize%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CWidth%3E0.7234524%3C%2FWidth%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CHeight%3E0.6881626%3C%2FHeight%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSize%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FObjectLayout%3E%0A%20%20%20%20%20%20%20%20%3C%2FQRCodeObject%3E%0A%20%20%20%20%20%20%20%20%3CTextObject%3E%0A%20%20%20%20%20%20%20%20%20%20%3CName%3EITextObject0%3C%2FName%3E%0A%20%20%20%20%20%20%20%20%20%20%3CBrushes%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CBackgroundBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%220%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FBackgroundBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CBorderBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FBorderBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CStrokeBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FStrokeBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CFillBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%220%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FFillBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FBrushes%3E%0A%20%20%20%20%20%20%20%20%20%20%3CRotation%3ERotation0%3C%2FRotation%3E%0A%20%20%20%20%20%20%20%20%20%20%3COutlineThickness%3E1%3C%2FOutlineThickness%3E%0A%20%20%20%20%20%20%20%20%20%20%3CIsOutlined%3EFalse%3C%2FIsOutlined%3E%0A%20%20%20%20%20%20%20%20%20%20%3CBorderStyle%3ESolidLine%3C%2FBorderStyle%3E%0A%20%20%20%20%20%20%20%20%20%20%3CMargin%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDYMOThickness%20Left%3D%220%22%20Top%3D%220%22%20Right%3D%220%22%20Bottom%3D%220%22%2F%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FMargin%3E%0A%20%20%20%20%20%20%20%20%20%20%3CHorizontalAlignment%3ECenter%3C%2FHorizontalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%3CVerticalAlignment%3EMiddle%3C%2FVerticalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%3CFitMode%3EAlwaysFit%3C%2FFitMode%3E%0A%20%20%20%20%20%20%20%20%20%20%3CIsVertical%3EFalse%3C%2FIsVertical%3E%0A%20%20%20%20%20%20%20%20%20%20%3CFormattedText%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CFitMode%3EAlwaysFit%3C%2FFitMode%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CHorizontalAlignment%3ECenter%3C%2FHorizontalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CVerticalAlignment%3EMiddle%3C%2FVerticalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CIsVertical%3EFalse%3C%2FIsVertical%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CLineTextSpan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CTextSpan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CText%3ETWOPATS.LIVE%3C%2FText%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CFontInfo%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CFontName%3ERoboto%20Condensed%3C%2FFontName%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CFontSize%3E6.8%3C%2FFontSize%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CIsBold%3ETrue%3C%2FIsBold%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CIsItalic%3EFalse%3C%2FIsItalic%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CIsUnderline%3EFalse%3C%2FIsUnderline%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CFontBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FFontBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FFontInfo%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FTextSpan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FLineTextSpan%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FFormattedText%3E%0A%20%20%20%20%20%20%20%20%20%20%3CObjectLayout%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDYMOPoint%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CX%3E0.2424704%3C%2FX%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CY%3E0.11%3C%2FY%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FDYMOPoint%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CSize%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CWidth%3E0.6808636%3C%2FWidth%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CHeight%3E0.125%3C%2FHeight%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSize%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FObjectLayout%3E%0A%20%20%20%20%20%20%20%20%3C%2FTextObject%3E%0A%20%20%20%20%20%20%20%20%3CTextObject%3E%0A%20%20%20%20%20%20%20%20%20%20%3CName%3EITextObject1%3C%2FName%3E%0A%20%20%20%20%20%20%20%20%20%20%3CBrushes%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CBackgroundBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%220%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FBackgroundBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CBorderBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FBorderBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CStrokeBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FStrokeBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CFillBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%220%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FFillBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FBrushes%3E%0A%20%20%20%20%20%20%20%20%20%20%3CRotation%3ERotation90%3C%2FRotation%3E%0A%20%20%20%20%20%20%20%20%20%20%3COutlineThickness%3E1%3C%2FOutlineThickness%3E%0A%20%20%20%20%20%20%20%20%20%20%3CIsOutlined%3EFalse%3C%2FIsOutlined%3E%0A%20%20%20%20%20%20%20%20%20%20%3CBorderStyle%3ESolidLine%3C%2FBorderStyle%3E%0A%20%20%20%20%20%20%20%20%20%20%3CMargin%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDYMOThickness%20Left%3D%220%22%20Top%3D%220%22%20Right%3D%220%22%20Bottom%3D%220%22%2F%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FMargin%3E%0A%20%20%20%20%20%20%20%20%20%20%3CHorizontalAlignment%3ECenter%3C%2FHorizontalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%3CVerticalAlignment%3EMiddle%3C%2FVerticalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%3CFitMode%3EAlwaysFit%3C%2FFitMode%3E%0A%20%20%20%20%20%20%20%20%20%20%3CIsVertical%3EFalse%3C%2FIsVertical%3E%0A%20%20%20%20%20%20%20%20%20%20%3CFormattedText%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CFitMode%3EAlwaysFit%3C%2FFitMode%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CHorizontalAlignment%3ECenter%3C%2FHorizontalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CVerticalAlignment%3EMiddle%3C%2FVerticalAlignment%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CIsVertical%3EFalse%3C%2FIsVertical%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CLineTextSpan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CTextSpan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CText%3ETEST%3C%2FText%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CFontInfo%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CFontName%3ERoboto%20Mono%3C%2FFontName%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CFontSize%3E2.6%3C%2FFontSize%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CIsBold%3EFalse%3C%2FIsBold%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CIsItalic%3EFalse%3C%2FIsItalic%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CIsUnderline%3EFalse%3C%2FIsUnderline%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CFontBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CColor%20A%3D%221%22%20R%3D%220%22%20G%3D%220%22%20B%3D%220%22%3E%20%3C%2FColor%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSolidColorBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FFontBrush%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FFontInfo%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FTextSpan%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FLineTextSpan%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FFormattedText%3E%0A%20%20%20%20%20%20%20%20%20%20%3CObjectLayout%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CDYMOPoint%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CX%3E0.04003381%3C%2FX%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CY%3E0.2601009%3C%2FY%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FDYMOPoint%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3CSize%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CWidth%3E0.1760034%3C%2FWidth%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3CHeight%3E0.6765177%3C%2FHeight%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C%2FSize%3E%0A%20%20%20%20%20%20%20%20%20%20%3C%2FObjectLayout%3E%0A%20%20%20%20%20%20%20%20%3C%2FTextObject%3E%0A%20%20%20%20%20%20%3C%2FLabelObjects%3E%0A%20%20%20%20%3C%2FDynamicLayoutManager%3E%0A%20%20%3C%2FDYMOLabel%3E%0A%20%20%3CLabelApplication%3EBlank%3C%2FLabelApplication%3E%0A%20%20%3CDataTable%3E%0A%20%20%20%20%3CColumns%2F%3E%0A%20%20%20%20%3CRows%2F%3E%0A%20%20%3C%2FDataTable%3E%0A%3C%2FDesktopLabel%3E" +
//   "&labelSetXml=";

// console.log("body", body);

const output = await fetch(
  "https://" + host + ":41951/DYMO/DLS/Printing/PrintLabel",
  {
    body,
    cache: "default",
    credentials: "omit",
    headers: {
      Accept: "*/*",
      "Accept-Language": "en-AU,en;q=0.9",
      "Content-Type": "application/x-www-form-urlencoded",
      "User-Agent":
        "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.4 Safari/605.1.15"
    },
    method: "POST",
    mode: "cors",
    redirect: "follow",
    referrer: "http://localhost:9001/"
  }
);

// console.log("output", output);
const outputText = await output.text();
console.log("output text", outputText);
